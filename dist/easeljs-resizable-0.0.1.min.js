this.createjs=this.createjs||{},function(){(createjs.Graphics.Polygon=function(t,e,s){this.x=t,this.y=e,this.points=s}).prototype.exec=function(t){var e=this.points[this.points.length-1];t.moveTo(e.x,e.y),this.points.forEach(function(e){t.lineTo(e.x,e.y)})},createjs.Graphics.prototype.drawPolygon=function(t,e,s){var i=[];if(Array.isArray(s))s.forEach(function(t){t=Array.isArray(t)?{x:t[0],y:t[1]}:t,i.push(t)});else{s=Array.prototype.slice.call(arguments).slice(2);var n=null;s.forEach(function(t){null===n?n=t:(i.push({x:n,y:t}),n=null)})}return this.append(new createjs.Graphics.Polygon(t,e,i))}}(),this.createjs=this.createjs||{},function(){function t(t,e){this.Shape_constructor(),this.update=!0,this.selected=!1,this.active=!1,this.x=t,this.y=e,this.radius=5,this.color="Blue",this.selectedColor="Pink",this.activeColor="Green",this.alpha=.7}var e=createjs.extend(t,createjs.Shape);e.onTick=function(){var t=this.color;this.selected&&(t=this.selectedColor),this.active&&(t=this.activeColor),this.graphics.clear().beginFill(t).drawCircle(0,0,this.radius)},e.toObject=function(){return{x:this.x,y:this.y}},this.createjs.Point=createjs.promote(t,"Shape")}(),this.createjs=this.createjs||{},function(t){function e(e){this.Container_constructor(),this.update=!0,this.selected=[],this.color="Red",this.ctrlKeyDown=!1,this.shape=new createjs.Shape,this.addChild(this.shape),this.points=e.map(function(t){var e;if(e=t instanceof createjs.Point?t:Array.isArray(t)?new createjs.Point(t[0],t[1]):new createjs.Point(t.x,t.y),!e)throw new Error("Invalid point added");return e}),this.addChild.apply(this,this.points),this.addEventListener("tick",this.onTick.bind(this)),this.addEventListener("mousedown",this.onMouseDown.bind(this)),this.onMouseUpBind=this.onMouseUp.bind(this),this.onMouseMoveBind=this.onMouseMove.bind(this),t.addEventListener("keydown",this.onKeyDown.bind(this)),t.addEventListener("keyup",this.onKeyUp.bind(this))}var s=createjs.extend(e,createjs.Container);s.selectPointsInRect=function(t){this.deselectAllPoints(),t&&(t.width<0&&(t.width=Math.abs(t.width),t.x-=t.width),t.height<0&&(t.height=Math.abs(t.height),t.y-=t.height),this.points.forEach(function(e){t.contains(this.x+e.x,this.y+e.y)&&(e.selected=!0,this.selected.push(e))},this),this.update=!0)},s.deselectAllPoints=function(){return this.selected.forEach(function(t){t.active=!1,t.selected=!1}),this.selected=[],this},s.onTick=function(){this.update&&(this.points.forEach(function(t){t.onTick()}),this.shape.graphics.clear().beginFill(this.color).drawPolygon(0,0,this.points.map(function(t){return t.toObject()})),this.update=!1)},s.onKeyDown=function(t){this.ctrlKeyDown=t.ctrlKey},s.onKeyUp=function(t){this.ctrlKeyDown=t.ctrlKey},s.onMouseDown=function(t){t.target instanceof createjs.Point?this.selected.indexOf(t.target)<0&&(this.deselectAllPoints(),t.target.selected=!0,this.selected=[t.target]):(this.deselectAllPoints(),this.selected=[this]),this.selected.forEach(function(t){t.active=!0,t.initX=t.x,t.initY=t.y}),this.startX=t.stageX,this.startY=t.stageY,this.mouseDown=!0,this.addEventListener("pressup",this.onMouseUpBind),this.addEventListener("pressmove",this.onMouseMoveBind),t.stopPropagation()},s.onMouseMove=function(t){this.mouseDown&&(this.selected.forEach(function(e){var s=!0,i=!0;this.ctrlKeyDown&&(Math.abs(t.stageX-this.startX)>Math.abs(t.stageY-this.startY)?i=!1:s=!1),e.x=s?e.initX+(t.stageX-this.startX):e.initX,e.y=i?e.initY+(t.stageY-this.startY):e.initY},this),this.update=!0,this.dispatchEvent(new createjs.Event("changed",!0)),t.stopPropagation())},s.onMouseUp=function(t){console.log(t),this.mouseDown=!1,this.selected.forEach(function(t){t.active=!1,t.initX=t.initY=null}),t.target instanceof createjs.Point||(this.selected=[]),this.startX=this.startY=null,this.removeEventListener("pressup",this.onMouseUpBind),this.removeEventListener("pressmove",this.onMouseMoveBind),this.update=!0,t.stopPropagation()},this.createjs.ResizableShape=createjs.promote(e,"Container")}(document),this.createjs=this.createjs||{},function(){function t(t,e){this.ResizableShape_constructor([{x:0,y:0},{x:t,y:0},{x:t,y:e},{x:0,y:e}])}var e=createjs.extend(t,createjs.ResizableShape);e.init=function(){console.log("asdasd")},this.createjs.ResizableRect=createjs.promote(t,"ResizableShape")}();